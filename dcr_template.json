{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "dataCollectionRuleName": {
      "type": "string",
      "metadata": {
        "description": "Specifies the name of the Data Collection Rule to create."
      }
    },
    "location": {
      "defaultValue": "[resourceGroup().location]",
      "type": "string",
      "metadata": {
        "description": "Specifies the location in which to create the Data Collection Rule."
      }
    },
    "workspaceResourceId": {
      "type": "string",
      "metadata": {
        "description": "Specifies the Azure resource ID of the Log Analytics workspace to use."
      }
    },
    "endpointResourceId": {
      "type": "string",
      "metadata": {
        "description": "Specifies the Azure resource ID of the Data Collection Endpoint to use."
      }
    }
  },
  "resources": [{
    "type": "Microsoft.Insights/dataCollectionRules",
    "apiVersion": "2021-09-01-preview",
    "name": "[parameters('dataCollectionRuleName')]",
    "location": "[parameters('location')]",
    "properties": {
      "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
      "streamDeclarations": {
        "Custom-CommonSecurityLog": {
          "columns": [{
              "name": "Activity",
              "type": "String"
            },
            {
              "name": "AdditionalExtensions",
              "type": "String"
            },
            {
              "name": "ApplicationProtocol",
              "type": "String"
            },
            {
              "name": "CollectorHostName",
              "type": "String"
            },
            {
              "name": "CommunicationDirection",
              "type": "String"
            },
            {
              "name": "Computer",
              "type": "String"
            },
            {
              "name": "DestinationDnsDomain",
              "type": "String"
            },
            {
              "name": "DestinationHostName",
              "type": "String"
            },
            {
              "name": "DestinationIP",
              "type": "String"
            },
            {
              "name": "DestinationMACAddress",
              "type": "String"
            },
            {
              "name": "DestinationNTDomain",
              "type": "String"
            },
            {
              "name": "DestinationPort",
              "type": "Int"
            },
            {
              "name": "DestinationProcessId",
              "type": "Int"
            },
            {
              "name": "DestinationProcessName",
              "type": "String"
            },
            {
              "name": "DestinationServiceName",
              "type": "String"
            },
            {
              "name": "DestinationTranslatedAddress",
              "type": "String"
            },
            {
              "name": "DestinationTranslatedPort",
              "type": "Int"
            },
            {
              "name": "DestinationUserID",
              "type": "String"
            },
            {
              "name": "DestinationUserName",
              "type": "String"
            },
            {
              "name": "DestinationUserPrivileges",
              "type": "String"
            },
            {
              "name": "DeviceAction",
              "type": "String"
            },
            {
              "name": "DeviceAddress",
              "type": "String"
            },
            {
              "name": "DeviceCustomDate1",
              "type": "String"
            },
            {
              "name": "DeviceCustomDate1Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomDate2",
              "type": "String"
            },
            {
              "name": "DeviceCustomDate2Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomFloatingPoint1",
              "type": "Real"
            },
            {
              "name": "DeviceCustomFloatingPoint1Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomFloatingPoint2",
              "type": "Real"
            },
            {
              "name": "DeviceCustomFloatingPoint2Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomFloatingPoint3",
              "type": "Real"
            },
            {
              "name": "DeviceCustomFloatingPoint3Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomFloatingPoint4",
              "type": "Real"
            },
            {
              "name": "DeviceCustomFloatingPoint4Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address1",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address1Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address2",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address2Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address3",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address3Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address4",
              "type": "String"
            },
            {
              "name": "DeviceCustomIPv6Address4Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomNumber1",
              "type": "Int"
            },
            {
              "name": "DeviceCustomNumber1Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomNumber2",
              "type": "Int"
            },
            {
              "name": "DeviceCustomNumber2Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomNumber3",
              "type": "Int"
            },
            {
              "name": "DeviceCustomNumber3Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString1",
              "type": "String"
            },
            {
              "name": "DeviceCustomString1Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString2",
              "type": "String"
            },
            {
              "name": "DeviceCustomString2Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString3",
              "type": "String"
            },
            {
              "name": "DeviceCustomString3Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString4",
              "type": "String"
            },
            {
              "name": "DeviceCustomString4Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString5",
              "type": "String"
            },
            {
              "name": "DeviceCustomString5Label",
              "type": "String"
            },
            {
              "name": "DeviceCustomString6",
              "type": "String"
            },
            {
              "name": "DeviceCustomString6Label",
              "type": "String"
            },
            {
              "name": "DeviceDnsDomain",
              "type": "String"
            },
            {
              "name": "DeviceEventCategory",
              "type": "String"
            },
            {
              "name": "DeviceEventClassID",
              "type": "String"
            },
            {
              "name": "DeviceExternalID",
              "type": "String"
            },
            {
              "name": "DeviceFacility",
              "type": "String"
            },
            {
              "name": "DeviceInboundInterface",
              "type": "String"
            },
            {
              "name": "DeviceMacAddress",
              "type": "String"
            },
            {
              "name": "DeviceName",
              "type": "String"
            },
            {
              "name": "DeviceNtDomain",
              "type": "String"
            },
            {
              "name": "DeviceOutboundInterface",
              "type": "String"
            },
            {
              "name": "DevicePayloadId",
              "type": "String"
            },
            {
              "name": "DeviceProduct",
              "type": "String"
            },
            {
              "name": "DeviceTimeZone",
              "type": "String"
            },
            {
              "name": "DeviceTranslatedAddress",
              "type": "String"
            },
            {
              "name": "DeviceVendor",
              "type": "String"
            },
            {
              "name": "DeviceVersion",
              "type": "String"
            },
            {
              "name": "EndTime",
              "type": "Datetime"
            },
            {
              "name": "EventCount",
              "type": "Int"
            },
            {
              "name": "EventOutcome",
              "type": "String"
            },
            {
              "name": "EventType",
              "type": "Int"
            },
            {
              "name": "ExternalID",
              "type": "Int"
            },
            {
              "name": "ExtID",
              "type": "String"
            },
            {
              "name": "FieldDeviceCustomNumber1",
              "type": "Long"
            },
            {
              "name": "FieldDeviceCustomNumber2",
              "type": "Long"
            },
            {
              "name": "FieldDeviceCustomNumber3",
              "type": "Long"
            },
            {
              "name": "FileCreateTime",
              "type": "String"
            },
            {
              "name": "FileHash",
              "type": "String"
            },
            {
              "name": "FileID",
              "type": "String"
            },
            {
              "name": "FileModificationTime",
              "type": "String"
            },
            {
              "name": "FileName",
              "type": "String"
            },
            {
              "name": "FilePath",
              "type": "String"
            },
            {
              "name": "FilePermission",
              "type": "String"
            },
            {
              "name": "FileSize",
              "type": "Int"
            },
            {
              "name": "FileType",
              "type": "String"
            },
            {
              "name": "FlexDate1",
              "type": "String"
            },
            {
              "name": "FlexDate1Label",
              "type": "String"
            },
            {
              "name": "FlexNumber1",
              "type": "Int"
            },
            {
              "name": "FlexNumber1Label",
              "type": "String"
            },
            {
              "name": "FlexNumber2",
              "type": "Int"
            },
            {
              "name": "FlexNumber2Label",
              "type": "String"
            },
            {
              "name": "FlexString1",
              "type": "String"
            },
            {
              "name": "FlexString1Label",
              "type": "String"
            },
            {
              "name": "FlexString2",
              "type": "String"
            },
            {
              "name": "FlexString2Label",
              "type": "String"
            },
            {
              "name": "IndicatorThreatType",
              "type": "String"
            },
            {
              "name": "LogSeverity",
              "type": "String"
            },
            {
              "name": "MaliciousIP",
              "type": "String"
            },
            {
              "name": "MaliciousIPCountry",
              "type": "String"
            },
            {
              "name": "MaliciousIPLatitude",
              "type": "Real"
            },
            {
              "name": "MaliciousIPLongitude",
              "type": "Real"
            },
            {
              "name": "Message",
              "type": "String"
            },
            {
              "name": "OldFileCreateTime",
              "type": "String"
            },
            {
              "name": "OldFileHash",
              "type": "String"
            },
            {
              "name": "OldFileID",
              "type": "String"
            },
            {
              "name": "OldFileModificationTime",
              "type": "String"
            },
            {
              "name": "OldFileName",
              "type": "String"
            },
            {
              "name": "OldFilePath",
              "type": "String"
            },
            {
              "name": "OldFilePermission",
              "type": "String"
            },
            {
              "name": "OldFileSize",
              "type": "Int"
            },
            {
              "name": "OldFileType",
              "type": "String"
            },
            {
              "name": "OriginalLogSeverity",
              "type": "String"
            },
            {
              "name": "ProcessID",
              "type": "Int"
            },
            {
              "name": "ProcessName",
              "type": "String"
            },
            {
              "name": "Protocol",
              "type": "String"
            },
            {
              "name": "Reason",
              "type": "String"
            },
            {
              "name": "ReceiptTime",
              "type": "String"
            },
            {
              "name": "ReceivedBytes",
              "type": "Long"
            },
            {
              "name": "RemoteIP",
              "type": "String"
            },
            {
              "name": "RemotePort",
              "type": "String"
            },
            {
              "name": "ReportReferenceLink",
              "type": "String"
            },
            {
              "name": "RequestClientApplication",
              "type": "String"
            },
            {
              "name": "RequestContext",
              "type": "String"
            },
            {
              "name": "RequestCookies",
              "type": "String"
            },
            {
              "name": "RequestMethod",
              "type": "String"
            },
            {
              "name": "RequestURL",
              "type": "String"
            },
            {
              "name": "SentBytes",
              "type": "Long"
            },
            {
              "name": "SimplifiedDeviceAction",
              "type": "String"
            },
            {
              "name": "SourceDnsDomain",
              "type": "String"
            },
            {
              "name": "SourceHostName",
              "type": "String"
            },
            {
              "name": "SourceIP",
              "type": "String"
            },
            {
              "name": "SourceMACAddress",
              "type": "String"
            },
            {
              "name": "SourceNTDomain",
              "type": "String"
            },
            {
              "name": "SourcePort",
              "type": "Int"
            },
            {
              "name": "SourceProcessId",
              "type": "Int"
            },
            {
              "name": "SourceProcessName",
              "type": "String"
            },
            {
              "name": "SourceServiceName",
              "type": "String"
            },
            {
              "name": "SourceSystem",
              "type": "String"
            },
            {
              "name": "SourceTranslatedAddress",
              "type": "String"
            },
            {
              "name": "SourceTranslatedPort",
              "type": "Int"
            },
            {
              "name": "SourceUserID",
              "type": "String"
            },
            {
              "name": "SourceUserName",
              "type": "String"
            },
            {
              "name": "SourceUserPrivileges",
              "type": "String"
            },
            {
              "name": "StartTime",
              "type": "Datetime"
            },
            {
              "name": "TenantId",
              "type": "Guid"
            },
            {
              "name": "ThreatConfidence",
              "type": "String"
            },
            {
              "name": "ThreatDescription",
              "type": "String"
            },
            {
              "name": "ThreatSeverity",
              "type": "Int"
            },
            {
              "name": "TimeGenerated",
              "type": "Datetime"
            },
            {
              "name": "Type",
              "type": "String"
            }
          ]
        },
        "Custom-SecurityEvent": {
          "columns": [{
              "name": "AccessList",
              "type": "String"
            },
            {
              "name": "AccessMask",
              "type": "String"
            },
            {
              "name": "AccessReason",
              "type": "String"
            },
            {
              "name": "Account",
              "type": "String"
            },
            {
              "name": "AccountDomain",
              "type": "String"
            },
            {
              "name": "AccountExpires",
              "type": "String"
            },
            {
              "name": "AccountName",
              "type": "String"
            },
            {
              "name": "AccountSessionIdentifier",
              "type": "String"
            },
            {
              "name": "AccountType",
              "type": "String"
            },
            {
              "name": "Activity",
              "type": "String"
            },
            {
              "name": "AdditionalInfo",
              "type": "String"
            },
            {
              "name": "AdditionalInfo2",
              "type": "String"
            },
            {
              "name": "AllowedToDelegateTo",
              "type": "String"
            },
            {
              "name": "Attributes",
              "type": "String"
            },
            {
              "name": "AuditPolicyChanges",
              "type": "String"
            },
            {
              "name": "AuditsDiscarded",
              "type": "Int"
            },
            {
              "name": "AuthenticationLevel",
              "type": "Int"
            },
            {
              "name": "AuthenticationPackageName",
              "type": "String"
            },
            {
              "name": "AuthenticationProvider",
              "type": "String"
            },
            {
              "name": "AuthenticationServer",
              "type": "String"
            },
            {
              "name": "AuthenticationService",
              "type": "Int"
            },
            {
              "name": "AuthenticationType",
              "type": "String"
            },
            {
              "name": "AzureDeploymentID",
              "type": "String"
            },
            {
              "name": "AzureTableName",
              "type": "String"
            },
            {
              "name": "CACertificateHash",
              "type": "String"
            },
            {
              "name": "CalledStationID",
              "type": "String"
            },
            {
              "name": "CallerProcessId",
              "type": "String"
            },
            {
              "name": "CallerProcessName",
              "type": "String"
            },
            {
              "name": "CallingStationID",
              "type": "String"
            },
            {
              "name": "CAPublicKeyHash",
              "type": "String"
            },
            {
              "name": "CategoryId",
              "type": "String"
            },
            {
              "name": "CertificateDatabaseHash",
              "type": "String"
            },
            {
              "name": "Channel",
              "type": "String"
            },
            {
              "name": "ClassId",
              "type": "String"
            },
            {
              "name": "ClassName",
              "type": "String"
            },
            {
              "name": "ClientAddress",
              "type": "String"
            },
            {
              "name": "ClientIPAddress",
              "type": "String"
            },
            {
              "name": "ClientName",
              "type": "String"
            },
            {
              "name": "CommandLine",
              "type": "String"
            },
            {
              "name": "CompatibleIds",
              "type": "String"
            },
            {
              "name": "Computer",
              "type": "String"
            },
            {
              "name": "Correlation",
              "type": "String"
            },
            {
              "name": "DCDNSName",
              "type": "String"
            },
            {
              "name": "DeviceDescription",
              "type": "String"
            },
            {
              "name": "DeviceId",
              "type": "String"
            },
            {
              "name": "DisplayName",
              "type": "String"
            },
            {
              "name": "Disposition",
              "type": "String"
            },
            {
              "name": "DomainBehaviorVersion",
              "type": "String"
            },
            {
              "name": "DomainName",
              "type": "String"
            },
            {
              "name": "DomainPolicyChanged",
              "type": "String"
            },
            {
              "name": "DomainSid",
              "type": "String"
            },
            {
              "name": "EAPType",
              "type": "String"
            },
            {
              "name": "ElevatedToken",
              "type": "String"
            },
            {
              "name": "ErrorCode",
              "type": "Int"
            },
            {
              "name": "EventData",
              "type": "String"
            },
            {
              "name": "EventID",
              "type": "Int"
            },
            {
              "name": "EventLevelName",
              "type": "String"
            },
            {
              "name": "EventOriginId",
              "type": "String"
            },
            {
              "name": "EventRecordId",
              "type": "String"
            },
            {
              "name": "EventSourceName",
              "type": "String"
            },
            {
              "name": "ExtendedQuarantineState",
              "type": "String"
            },
            {
              "name": "FailureReason",
              "type": "String"
            },
            {
              "name": "FileHash",
              "type": "String"
            },
            {
              "name": "FilePath",
              "type": "String"
            },
            {
              "name": "FilePathNoUser",
              "type": "String"
            },
            {
              "name": "Filter",
              "type": "String"
            },
            {
              "name": "ForceLogoff",
              "type": "String"
            },
            {
              "name": "Fqbn",
              "type": "String"
            },
            {
              "name": "FullyQualifiedSubjectMachineName",
              "type": "String"
            },
            {
              "name": "FullyQualifiedSubjectUserName",
              "type": "String"
            },
            {
              "name": "GroupMembership",
              "type": "String"
            },
            {
              "name": "HandleId",
              "type": "String"
            },
            {
              "name": "HardwareIds",
              "type": "String"
            },
            {
              "name": "HomeDirectory",
              "type": "String"
            },
            {
              "name": "HomePath",
              "type": "String"
            },
            {
              "name": "ImpersonationLevel",
              "type": "String"
            },
            {
              "name": "InterfaceUuid",
              "type": "Guid"
            },
            {
              "name": "IpAddress",
              "type": "String"
            },
            {
              "name": "IpPort",
              "type": "String"
            },
            {
              "name": "KeyLength",
              "type": "Int"
            },
            {
              "name": "Keywords",
              "type": "String"
            },
            {
              "name": "Level",
              "type": "String"
            },
            {
              "name": "LmPackageName",
              "type": "String"
            },
            {
              "name": "LocationInformation",
              "type": "String"
            },
            {
              "name": "LockoutDuration",
              "type": "String"
            },
            {
              "name": "LockoutObservationWindow",
              "type": "String"
            },
            {
              "name": "LockoutThreshold",
              "type": "String"
            },
            {
              "name": "LoggingResult",
              "type": "String"
            },
            {
              "name": "LogonGuid",
              "type": "Guid"
            },
            {
              "name": "LogonHours",
              "type": "String"
            },
            {
              "name": "LogonID",
              "type": "String"
            },
            {
              "name": "LogonProcessName",
              "type": "String"
            },
            {
              "name": "LogonType",
              "type": "Int"
            },
            {
              "name": "LogonTypeName",
              "type": "String"
            },
            {
              "name": "MachineAccountQuota",
              "type": "String"
            },
            {
              "name": "MachineInventory",
              "type": "String"
            },
            {
              "name": "MachineLogon",
              "type": "String"
            },
            {
              "name": "ManagementGroupName",
              "type": "String"
            },
            {
              "name": "MandatoryLabel",
              "type": "String"
            },
            {
              "name": "MaxPasswordAge",
              "type": "String"
            },
            {
              "name": "MemberName",
              "type": "String"
            },
            {
              "name": "MemberSid",
              "type": "String"
            },
            {
              "name": "MG",
              "type": "Guid"
            },
            {
              "name": "MinPasswordAge",
              "type": "String"
            },
            {
              "name": "MinPasswordLength",
              "type": "String"
            },
            {
              "name": "MixedDomainMode",
              "type": "String"
            },
            {
              "name": "NASIdentifier",
              "type": "String"
            },
            {
              "name": "NASIPv4Address",
              "type": "String"
            },
            {
              "name": "NASIPv6Address",
              "type": "String"
            },
            {
              "name": "NASPort",
              "type": "String"
            },
            {
              "name": "NASPortType",
              "type": "String"
            },
            {
              "name": "NetworkPolicyName",
              "type": "String"
            },
            {
              "name": "NewDate",
              "type": "String"
            },
            {
              "name": "NewMaxUsers",
              "type": "String"
            },
            {
              "name": "NewProcessId",
              "type": "String"
            },
            {
              "name": "NewProcessName",
              "type": "String"
            },
            {
              "name": "NewRemark",
              "type": "String"
            },
            {
              "name": "NewShareFlags",
              "type": "String"
            },
            {
              "name": "NewTime",
              "type": "String"
            },
            {
              "name": "NewUacValue",
              "type": "String"
            },
            {
              "name": "NewValue",
              "type": "String"
            },
            {
              "name": "NewValueType",
              "type": "String"
            },
            {
              "name": "ObjectName",
              "type": "String"
            },
            {
              "name": "ObjectServer",
              "type": "String"
            },
            {
              "name": "ObjectType",
              "type": "String"
            },
            {
              "name": "ObjectValueName",
              "type": "String"
            },
            {
              "name": "OemInformation",
              "type": "String"
            },
            {
              "name": "OldMaxUsers",
              "type": "String"
            },
            {
              "name": "OldRemark",
              "type": "String"
            },
            {
              "name": "OldShareFlags",
              "type": "String"
            },
            {
              "name": "OldUacValue",
              "type": "String"
            },
            {
              "name": "OldValue",
              "type": "String"
            },
            {
              "name": "OldValueType",
              "type": "String"
            },
            {
              "name": "Opcode",
              "type": "String"
            },
            {
              "name": "OperationType",
              "type": "String"
            },
            {
              "name": "PackageName",
              "type": "String"
            },
            {
              "name": "ParentProcessName",
              "type": "String"
            },
            {
              "name": "PartitionKey",
              "type": "String"
            },
            {
              "name": "PasswordHistoryLength",
              "type": "String"
            },
            {
              "name": "PasswordLastSet",
              "type": "String"
            },
            {
              "name": "PasswordProperties",
              "type": "String"
            },
            {
              "name": "PreviousDate",
              "type": "String"
            },
            {
              "name": "PreviousTime",
              "type": "String"
            },
            {
              "name": "PrimaryGroupId",
              "type": "String"
            },
            {
              "name": "PrivateKeyUsageCount",
              "type": "String"
            },
            {
              "name": "PrivilegeList",
              "type": "String"
            },
            {
              "name": "Process",
              "type": "String"
            },
            {
              "name": "ProcessId",
              "type": "String"
            },
            {
              "name": "ProcessName",
              "type": "String"
            },
            {
              "name": "ProfilePath",
              "type": "String"
            },
            {
              "name": "Properties",
              "type": "String"
            },
            {
              "name": "ProtocolSequence",
              "type": "String"
            },
            {
              "name": "ProxyPolicyName",
              "type": "String"
            },
            {
              "name": "QuarantineHelpURL",
              "type": "String"
            },
            {
              "name": "QuarantineSessionID",
              "type": "String"
            },
            {
              "name": "QuarantineSessionIdentifier",
              "type": "String"
            },
            {
              "name": "QuarantineState",
              "type": "String"
            },
            {
              "name": "QuarantineSystemHealthResult",
              "type": "String"
            },
            {
              "name": "RelativeTargetName",
              "type": "String"
            },
            {
              "name": "RemoteIpAddress",
              "type": "String"
            },
            {
              "name": "RemotePort",
              "type": "String"
            },
            {
              "name": "Requester",
              "type": "String"
            },
            {
              "name": "RequestId",
              "type": "String"
            },
            {
              "name": "RestrictedAdminMode",
              "type": "String"
            },
            {
              "name": "RowKey",
              "type": "String"
            },
            {
              "name": "RowsDeleted",
              "type": "String"
            },
            {
              "name": "SamAccountName",
              "type": "String"
            },
            {
              "name": "ScriptPath",
              "type": "String"
            },
            {
              "name": "SecurityDescriptor",
              "type": "String"
            },
            {
              "name": "ServiceAccount",
              "type": "String"
            },
            {
              "name": "ServiceFileName",
              "type": "String"
            },
            {
              "name": "ServiceName",
              "type": "String"
            },
            {
              "name": "ServiceStartType",
              "type": "Int"
            },
            {
              "name": "ServiceType",
              "type": "String"
            },
            {
              "name": "SessionName",
              "type": "String"
            },
            {
              "name": "ShareLocalPath",
              "type": "String"
            },
            {
              "name": "ShareName",
              "type": "String"
            },
            {
              "name": "SidHistory",
              "type": "String"
            },
            {
              "name": "SourceComputerId",
              "type": "Guid"
            },
            {
              "name": "SourceSystem",
              "type": "String"
            },
            {
              "name": "Status",
              "type": "String"
            },
            {
              "name": "StorageAccount",
              "type": "String"
            },
            {
              "name": "SubcategoryGuid",
              "type": "Guid"
            },
            {
              "name": "SubcategoryId",
              "type": "String"
            },
            {
              "name": "Subject",
              "type": "String"
            },
            {
              "name": "SubjectAccount",
              "type": "String"
            },
            {
              "name": "SubjectDomainName",
              "type": "String"
            },
            {
              "name": "SubjectKeyIdentifier",
              "type": "String"
            },
            {
              "name": "SubjectLogonId",
              "type": "String"
            },
            {
              "name": "SubjectMachineName",
              "type": "String"
            },
            {
              "name": "SubjectMachineSID",
              "type": "String"
            },
            {
              "name": "SubjectUserName",
              "type": "String"
            },
            {
              "name": "SubjectUserSid",
              "type": "String"
            },
            {
              "name": "SubStatus",
              "type": "String"
            },
            {
              "name": "SystemProcessId",
              "type": "Int"
            },
            {
              "name": "SystemThreadId",
              "type": "Int"
            },
            {
              "name": "SystemUserId",
              "type": "String"
            },
            {
              "name": "TableId",
              "type": "String"
            },
            {
              "name": "TargetAccount",
              "type": "String"
            },
            {
              "name": "TargetDomainName",
              "type": "String"
            },
            {
              "name": "TargetInfo",
              "type": "String"
            },
            {
              "name": "TargetLinkedLogonId",
              "type": "String"
            },
            {
              "name": "TargetLogonGuid",
              "type": "Guid"
            },
            {
              "name": "TargetLogonId",
              "type": "String"
            },
            {
              "name": "TargetOutboundDomainName",
              "type": "String"
            },
            {
              "name": "TargetOutboundUserName",
              "type": "String"
            },
            {
              "name": "TargetServerName",
              "type": "String"
            },
            {
              "name": "TargetSid",
              "type": "String"
            },
            {
              "name": "TargetUser",
              "type": "String"
            },
            {
              "name": "TargetUserName",
              "type": "String"
            },
            {
              "name": "TargetUserSid",
              "type": "String"
            },
            {
              "name": "Task",
              "type": "Int"
            },
            {
              "name": "TemplateContent",
              "type": "String"
            },
            {
              "name": "TemplateDSObjectFQDN",
              "type": "String"
            },
            {
              "name": "TemplateInternalName",
              "type": "String"
            },
            {
              "name": "TemplateOID",
              "type": "String"
            },
            {
              "name": "TemplateSchemaVersion",
              "type": "String"
            },
            {
              "name": "TemplateVersion",
              "type": "String"
            },
            {
              "name": "TenantId",
              "type": "Guid"
            },
            {
              "name": "TimeCollected",
              "type": "Datetime"
            },
            {
              "name": "TimeGenerated",
              "type": "Datetime"
            },
            {
              "name": "TokenElevationType",
              "type": "String"
            },
            {
              "name": "TransmittedServices",
              "type": "String"
            },
            {
              "name": "Type",
              "type": "String"
            },
            {
              "name": "UserAccountControl",
              "type": "String"
            },
            {
              "name": "UserParameters",
              "type": "String"
            },
            {
              "name": "UserPrincipalName",
              "type": "String"
            },
            {
              "name": "UserWorkstations",
              "type": "String"
            },
            {
              "name": "VendorIds",
              "type": "String"
            },
            {
              "name": "Version",
              "type": "Int"
            },
            {
              "name": "VirtualAccount",
              "type": "String"
            },
            {
              "name": "Workstation",
              "type": "String"
            },
            {
              "name": "WorkstationName",
              "type": "String"
            }
          ]
        },
        "Custom-Syslog": {
          "columns": [{
              "name": "CollectorHostName",
              "type": "String"
            },
            {
              "name": "Computer",
              "type": "String"
            },
            {
              "name": "EventTime",
              "type": "Datetime"
            },
            {
              "name": "Facility",
              "type": "String"
            },
            {
              "name": "HostIP",
              "type": "String"
            },
            {
              "name": "HostName",
              "type": "String"
            },
            {
              "name": "ManagementGroupName",
              "type": "String"
            },
            {
              "name": "MG",
              "type": "Guid"
            },
            {
              "name": "ProcessID",
              "type": "Int"
            },
            {
              "name": "ProcessName",
              "type": "String"
            },
            {
              "name": "SeverityLevel",
              "type": "String"
            },
            {
              "name": "SourceSystem",
              "type": "String"
            },
            {
              "name": "SyslogMessage",
              "type": "String"
            },
            {
              "name": "TenantId",
              "type": "Guid"
            },
            {
              "name": "TimeCollected",
              "type": "Datetime"
            },
            {
              "name": "TimeGenerated",
              "type": "Datetime"
            },
            {
              "name": "Type",
              "type": "String"
            }
          ]
        },
        "Custom-WindowsEvent": {
          "columns": [{
              "name": "Channel",
              "type": "String"
            },
            {
              "name": "Computer",
              "type": "String"
            },
            {
              "name": "Correlation",
              "type": "String"
            },
            {
              "name": "Data",
              "type": "Dynamic"
            },
            {
              "name": "EventData",
              "type": "Dynamic"
            },
            {
              "name": "EventID",
              "type": "Int"
            },
            {
              "name": "EventLevel",
              "type": "Int"
            },
            {
              "name": "EventLevelName",
              "type": "String"
            },
            {
              "name": "EventOriginId",
              "type": "String"
            },
            {
              "name": "EventRecordId",
              "type": "String"
            },
            {
              "name": "Keywords",
              "type": "String"
            },
            {
              "name": "ManagementGroupName",
              "type": "String"
            },
            {
              "name": "Opcode",
              "type": "String"
            },
            {
              "name": "Provider",
              "type": "String"
            },
            {
              "name": "RawEventData",
              "type": "String"
            },
            {
              "name": "SourceSystem",
              "type": "String"
            },
            {
              "name": "SystemProcessId",
              "type": "Int"
            },
            {
              "name": "SystemThreadId",
              "type": "Int"
            },
            {
              "name": "SystemUserId",
              "type": "String"
            },
            {
              "name": "Task",
              "type": "Int"
            },
            {
              "name": "TenantId",
              "type": "Guid"
            },
            {
              "name": "TimeCreated",
              "type": "Datetime"
            },
            {
              "name": "TimeGenerated",
              "type": "Datetime"
            },
            {
              "name": "Type",
              "type": "String"
            },
            {
              "name": "Version",
              "type": "Int"
            }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [{
          "workspaceResourceId": "[parameters('workspaceResourceId')]",
          "name": "logAnalyticsWorkspace"
        }]
      },
      "dataFlows": [{
          "streams": [
            "Custom-CommonSecurityLog"
          ],
          "destinations": [
            "logAnalyticsWorkspace"
          ],
          "transformKql": "source",
          "outputStream": "Microsoft-CommonSecurityLog"
        },
        {
          "streams": [
            "Custom-SecurityEvent"
          ],
          "destinations": [
            "logAnalyticsWorkspace"
          ],
          "transformKql": "source",
          "outputStream": "Microsoft-SecurityEvent"
        },
        {
          "streams": [
            "Custom-Syslog"
          ],
          "destinations": [
            "logAnalyticsWorkspace"
          ],
          "transformKql": "source",
          "outputStream": "Microsoft-Syslog"
        },
        {
          "streams": [
            "Custom-WindowsEvent"
          ],
          "destinations": [
            "logAnalyticsWorkspace"
          ],
          "transformKql": "source",
          "outputStream": "Microsoft-WindowsEvent"
        }
      ]
    }
  }],
  "outputs": {
    "dataCollectionRuleId": {
      "type": "string",
      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('dataCollectionRuleName'))]"
    }
  }
}
